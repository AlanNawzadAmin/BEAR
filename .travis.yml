language: python
python:
  - 3.6
cache:
  directories:
    - $HOME/.cache/pip
    - $HOME/.ccache  # https://github.com/travis-ci/travis-ci/issues/5853

env:
  global:
    # Doctr deploy key for AlanNawzadAmin/BEAR
    - secure: "YcJkeX9Uwhh4xM/x4tnwxO5+MjfplBV3yRAcvG9J1RiufytIOIKdDM7KiLROxiHsSW6EpIaXFh11ZNZpGLkfrh2+/0D764Wyp3mVgLaUHhqpU0BgUjT3Ka4PDMVXXjgnQkgym3VWau4X3ZKzm+3BzAYBTFnx5GY5/kaWGq3vynL95ZgvnS+pcBmL0y1w4ZZzIRY0ZKpXaPT9dI4Lg6obuIRvN2e7mJQ3sL342J1mN/fBDUy+7rX5zlSCeAbABHYwtEAeOyrQxIlJWVqSCpdPxNRaoW/oHYVM+uryLIbZMWn6QyjZ2KdJLSzVkvGXSjjpRCIlD0n6wGzRn7lKQkodZt3p9YyaNnN8Nz5EQbycsTYqVa6B9e6qYEFvV0Ndne95yM5P+fSVcE0oRR9yn+fmRi/OgGUE/lh9ZYOg8tnkTYGqLoMNijdB2OWCWFcqiHuPrWghPTGcQm4Gkba+YiPJ4CbANixlc3xrodSvRMDP+TqMWVgTIjtCGhw7jwHMCArR0aPpDOSh9c8VPSQwEA0YRipVfpjxORhV8LKF8SNcESktWZQZPFPApPNgdXgJ5t/w1kq0UqheCz5m1qygzgScH+yMKVT6x5XhEqsRJBoSIxUi4ofqCjDLlyzRiWHJ89zjBqGZWFIE4mM1Q3Up4dHsUoYuUYl5SoIVwe8VjlSyx40="

install:
  # The versions of pip and numpy that come pre-installed are often too old and
  # can cause problems. Upgrade them.
  - pip install --upgrade pip numpy
  # Install this package and the packages listed in requirements.txt.
  - pip install .
  # Install extra requirements for running tests and building docs.
  - pip install -r requirements-dev.txt

script:
  - coverage run -m pytest  # Run the tests and check for test coverage.
  - coverage report -m  # Generate test coverage report.
  - codecov  # Upload the report to codecov.
  - flake8  # Enforce code style ('relaxed' line length limit is set in .flake8 config file).
  - set -e
  - make -C docs html  # Build the documentation.
  - pip install doctr
  - doctr deploy --built-docs docs/build/html .  # Publish the documentation.
